<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>MySQL Slow Query Log Visualizer</title>
        <link rel="stylesheet" href="css/style.css">
        <script src="js/jquery-3.7.1.min.js"></script>
        <script src="js/chartjs/chart.umd.js"></script>
        <script src="js/lodash.js"></script>
        <script src="js/clipboard.min.js"></script>
        <script src="js/list.min.js"></script>
        <script src="js/script.js"></script>
    </head>
    <body>
        <div id="githubLink">
            <a href="https://github.com/shoulders/mysql-slow-query-log-visualizer" target="_blank">
                <img src="images/github-mark-white.png" /><br />Instructions
            </a>
        </div>

        <div id="information" class="information-block">
            <h1>MySQL Slow Query Log Visualizer</h1>
            <em>If you need to process very large files (&gt;500MB), you will have to call Chrome with <strong>--js-flags="--max-old-space-size=5000"</strong> parameter to increase memory allocatable by Chrome to 5GB</em>
        </div>

        <div id="dropZone">Drop log file here</div>

        <div id="logInformation" class="information-block" hidden>
            <h2>Log Information</h2>
            <ul>
                <li><span class="item-title">Server: </span><span id="logInformationServerDetails">Not available</span></li>
                <li><span class="item-title">File: </span><span id="logInformationFile">Not available</span></li>
                <li><span class="item-title">Records: </span><span id="logInformationRecordCount">Not available</span></li>
                <li><span class="item-title">Start Date: </span><span id="logInformationStartDate">Not available</span></li>
                <li><span class="item-title">End Date: </span><span id="logInformationEndDate">Not available</span></li>
            </ul>
        </div>

        <!-- Global Chart -->
        <div id="globalChartContainer" class="chart-container" hidden>
            <div class="information-block">
                <h2>GLOBAL CHART</h2>
                <ul>
                    <li>
                        <span class="item-title">Group By: </span>
                        <select id="globalChartTimeScale">
                            <option value="month">Month</option>
                            <option value="week">Week</option>
                            <option value="day">Day</option>
                            <option value="hour" selected>Hour</option>
                            <option value="minute">Minute</option>
                            <option value="aggregatedWeekdays">Aggregated Weekdays</option>
                            <option value="aggregatedWeekdayHours">Aggregated Weekday Hours</option>
                            <option value="aggregatedDays">Aggregated Days</option>
                            <option value="aggregatedHours">Aggregated Hours</option>
                        </select>
                    </li>
                    <li><span class="item-title">Displaying: </span><span id="globalChartRecordCount"></span> queries</li>
                    <li><button id="resetFilter" onclick="resetPage();">Reset Filter</button></li>
                </ul>
            </div>
            <canvas id="globalChart" class="chart"></canvas>
        </div>

        <br /><br />

        <!-- Working Chart -->
        <div id="workingChartContainer" class="chart-container" hidden>
            <div class="information-block">
                <h2>WORKING CHART</h2>
                <ul>
                    <li>
                        <span class="item-title">Group By: </span>
                        <select id="workingChartTimeScale">
                            <option value="month">Month</option>
                            <option value="week">Week</option>
                            <option value="day">Day</option>
                            <option value="hour" selected>Hour</option>
                            <option value="minute">Minute</option>
                        </select>
                    </li>
                    <li><span class="item-title">Displaying: </span><span id="workingChartRecordCount"></span> queries</li>
                    <li id="appliedFilter"><span class="item-title">Chart Range: </span><span class="item-subtitle">start</span> = <span id="filterStart"></span>, <span class="item-subtitle">end</span> = <span id="filterEnd"></span></li>
                </ul>
            </div>
            <canvas id="workingChart" class="chart"></canvas>
        </div>

        <!-- Table -->
        <div id="logListContainer" hidden>
            <table id="logList">
                <thead class="header">
                    <tr id="search">
                        <th colspan="10">
                            <span class="list-search">
                                Showing <span id="listItemsCountShowing"></span> of <span id="listItemsCountShowingOf"></span> records
                                (Filtered: <span id="listItemsCountFiltered"></span> / Visible: <span id="listItemsCountVisible"></span> / Total: <span id="listItemsCountTotal"></span>)
                                <label for="logListSearch">Filter:</label>
                                <input id="logListSearch" />
                            </span>
                            <div class="pagination-container">
                                <a class="prevnext-button pagination-prev page" href="#" hidden>&lt;</a><ul class="pagination pagination-top"></ul><a class="prevnext-button pagination-next page" href="#" hidden>&gt;</a>
                            </div>
                        </th>
                    </tr>
                    <tr>
                        <th scope="col" class="sort asc" data-sort="time"><p>Time<br>(Local)</p><span class="sort-icon"></span></th>
                        <th scope="col" class="sort" data-sort="query_duration"><p>Query Duration<br>(Seconds)</p><span class="sort-icon"></span></th>
                        <th scope="col" class="sort" data-sort="lock_duration"><p>Lock Duration<br>(Seconds)</p><span class="sort-icon"></span></th>
                        <th scope="col" class="sort" data-sort="rows_sent"><p>Rows Sent</p><span class="sort-icon"></span></th>
                        <th scope="col" class="sort" data-sort="rows_examined"><p>Rows Examined</p><span class="sort-icon"></span></th>
                        <th scope="col" class="sort" data-sort="db_name"><p>DB Name</p><span class="sort-icon"></span></th>
                        <th scope="col" class="sort" data-sort="query_pattern_global_occurences"><p>Query Pattern Occurences<br>(Global Data)<br>(Stripped WHERE)</p><span class="sort-icon"></span></th>
                        <th scope="col" class="sort" data-sort="query_pattern_filtered_occurences"><p>Query Pattern Occurences<br>(Working Data)<br>(Stripped WHERE)</p><span class="sort-icon"></span></th>
                        <th scope="col" class="sort" data-sort="query_string"><p>Query String</p><span class="sort-icon"></span></th>
                        <th scope="col" class="sort" data-sort="query_with_stripped_where_clauses"><p>Query String<br>(Stripped WHERE)</p><span class="sort-icon"></span></th>
                    </tr>
                </thead>
                <tbody class="list">
                    <tr id="logListItem">
                        <th scope="row" class="date"></th>
                        <td class="query_duration"></td>
                        <td class="lock_duration"></td>
                        <td class="rows_sent"></td>
                        <td class="rows_examined"></td>
                        <td class="db_name"></td>
                        <td class="query_pattern_global_occurences"></td>
                        <td class="query_pattern_filtered_occurences"></td>
                        <td class="qs"><pre class="query_string"></pre></td>
                        <td class="qs"><pre class="query_with_stripped_where_clauses"></pre></td>
                    </tr>
                </tbody>
                <tfoot>
                    <th colspan="10">
                        <div class="pagination-container">
                            <a class="prevnext-button pagination-prev page" href="#" hidden>&lt;</a><ul class="pagination pagination-bottom"></ul><a class="prevnext-button pagination-next page" href="#" hidden>&gt;</a>
                        </div>
                        <div id="noRecords" hidden>No Records</div>
                    </th>
                </tfoot>
            </table>
        </div>
        <div id="footer">
            <p>MySQL Slow Query Log Visualizer</p>
            <p>&copy; 2015 <a href="http://www.4sh.fr">4SH</a> and <a href="http://www.neurofuzzy.net">Neurofuzzy Consulting</a></p>
            <p>&copy; 2025 - shoulders from <a href="https://quantunmwarp.com/">QuantumWarp</a></p>
        </div>
    </body>
</html>
